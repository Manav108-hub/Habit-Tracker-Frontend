{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.ts"],"sourcesContent":["// middleware.ts - Protect admin routes\nimport { NextResponse } from 'next/server';\nimport type { NextRequest } from 'next/server';\n\nexport async function middleware(request: NextRequest) {\n  const { pathname } = request.nextUrl;\n\n  // Check if accessing admin routes\n  if (pathname.startsWith('/admin')) {\n    const accessToken = request.cookies.get('access_token');\n\n    // If no token, redirect to login\n    if (!accessToken) {\n      return NextResponse.redirect(new URL('/login', request.url));\n    }\n\n    // Verify user is admin by checking with backend\n    try {\n      const API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000/api';\n      const response = await fetch(`${API_URL}/me`, {\n        headers: {\n          Cookie: `access_token=${accessToken.value}`,\n        },\n      });\n\n      if (!response.ok) {\n        return NextResponse.redirect(new URL('/login', request.url));\n      }\n\n      const user = await response.json();\n\n      // Check if user has admin privileges\n      if (user.role !== 'admin' && user.role !== 'super_admin') {\n        return NextResponse.redirect(new URL('/dashboard', request.url));\n      }\n\n      // Allow access\n      return NextResponse.next();\n    } catch (error) {\n      console.error('Middleware auth check failed:', error);\n      return NextResponse.redirect(new URL('/login', request.url));\n    }\n  }\n\n  // For dashboard routes, just check if authenticated\n  if (pathname.startsWith('/dashboard')) {\n    const accessToken = request.cookies.get('access_token');\n    if (!accessToken) {\n      return NextResponse.redirect(new URL('/login', request.url));\n    }\n  }\n\n  return NextResponse.next();\n}\n\nexport const config = {\n  matcher: ['/admin/:path*', '/dashboard/:path*'],\n};"],"names":[],"mappings":"AAAA,uCAAuC;;;;;;;AACvC;AAAA;;AAGO,eAAe,WAAW,OAAoB;IACnD,MAAM,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IAEpC,kCAAkC;IAClC,IAAI,SAAS,UAAU,CAAC,WAAW;QACjC,MAAM,cAAc,QAAQ,OAAO,CAAC,GAAG,CAAC;QAExC,iCAAiC;QACjC,IAAI,CAAC,aAAa;YAChB,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC5D;QAEA,gDAAgD;QAChD,IAAI;YACF,MAAM,UAAU,QAAQ,GAAG,CAAC,mBAAmB,IAAI;YACnD,MAAM,WAAW,MAAM,MAAM,GAAG,QAAQ,GAAG,CAAC,EAAE;gBAC5C,SAAS;oBACP,QAAQ,CAAC,aAAa,EAAE,YAAY,KAAK,EAAE;gBAC7C;YACF;YAEA,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;YAC5D;YAEA,MAAM,OAAO,MAAM,SAAS,IAAI;YAEhC,qCAAqC;YACrC,IAAI,KAAK,IAAI,KAAK,WAAW,KAAK,IAAI,KAAK,eAAe;gBACxD,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,cAAc,QAAQ,GAAG;YAChE;YAEA,eAAe;YACf,OAAO,gMAAY,CAAC,IAAI;QAC1B,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,iCAAiC;YAC/C,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC5D;IACF;IAEA,oDAAoD;IACpD,IAAI,SAAS,UAAU,CAAC,eAAe;QACrC,MAAM,cAAc,QAAQ,OAAO,CAAC,GAAG,CAAC;QACxC,IAAI,CAAC,aAAa;YAChB,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC5D;IACF;IAEA,OAAO,gMAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAiB;KAAoB;AACjD"}}]
}